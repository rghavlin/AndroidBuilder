Please always refer universalgoals.md and the current statemachineproject.md. Please review recent chat. Note the changes we made to map transition. Please do not make any changes at this time. After the previous attempt at a solution, when loading a game, the camera does not update to the player's position in the save game. The camera remains where it was before the load. Also, map transitions are still not moving the player to the south of the map. The player remains at the top of the map. The previous solution seems to have caused new problems without fixing the existing problems. Was the previous solution correct? Here is the previous solution:  Based on the analysis in the attached file and reviewing the recent chat history, I'll implement the comprehensive fix strategy for the map transition issues. The solution addresses animation interference, save corruption, and timing issues.

Implementation Plan
I'll implement all four fixes in the correct order:

Fix 1: Add animation cancellation with proper wait at the START of executeMapTransition
Fix 2: Use player's actual position for camera centering
Fix 3: Remove the conflicting PATCH code
Fix 4: Add autosave validation to prevent saving empty maps
Let me implement these fixes:

client/src/contexts/GameMapContext.jsx
client/src/contexts/GameContext.jsx
Summary of Fixes
✅ Fix 1: Animation cancellation with 150ms wait at the START of executeMapTransition - ensures movement is fully stopped before any map operations

✅ Fix 2: Camera centers on player's ACTUAL position (currentPlayerRef.x, currentPlayerRef.y) instead of spawn variables - follows the real player location

✅ Fix 3: Removed conflicting PATCH code that was re-placing the player after animation - player position is now set once and remains consistent

✅ Fix 4: Added autosave validation in performAutosave - prevents saving maps with 0 entities by checking for player presence first

These fixes ensure:

Animation is fully stopped before transition begins
Player position is set once and remains consistent
Camera follows the actual player position
Only valid game states with players are saved
The map transition should now work correctly, with the player spawning at the correct position and autosave functioning properly after transitions.