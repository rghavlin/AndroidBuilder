PlayerContext: Add a version bump pattern mirroring Camera/GameMap:

Keep playerRef as source of truth.

Provide a setPlayerRef(p) (or equivalent) that sets playerRef.current = p and bumps playerVersion.

useMemo the context value with [playerVersion] so consumers can re-render when needed.

GameContext (or GameContext.jsx/tsx that acts as orchestrator):

Remove any useGame() aggregator. Do not mirror camera/map/player on GameContext.

After “contexts synchronized” logs, instantiate TurnManager if needed, call startPlayerTurn() (or the project’s equivalent), and set any local isPlayerTurn ref/flag true.

Implement endTurn() that:

calls turnManager.endPlayerTurn() → runs AI (runAIPhase() or equivalent) → startPlayerTurn() again,

updates any local ref flags (and optionally bumps a small version counter if a UI needs to re-render).

Ensure exports expose stable functions (initializeGame, endTurn, etc.) and never re-expose sub-context state.

MapCanvas.jsx:

Use sub-contexts directly: gameMapRef, cameraRef, playerRef.

Make onMouseMove independent of “player turn” guards; bail only if refs/canvas are missing.

Fix the hover call to pass the player: handleTileHover(x, y, playerRef.current).

Keep hot-reload guards; if refs are null, render the “Loading game components…” stub.

GameControls.tsx & InventoryPanel.tsx (and any UI still reading GameContext for data):

Stop using useGame(); read needed data/functions from the appropriate sub-contexts (refs) and from the GameContext orchestration API (e.g., endTurn()).

Save/Load:

Rewrite to query/write through sub-contexts/refs (camera/map/player). GameContext should only orchestrate the sequence.

Provider order & imports:

Ensure PlayerProvider → CameraProvider → GameMapProvider → GameProvider.

Normalize import paths and extensions to match existing files; remove any useGame export and its imports.

Acceptance tests (add logs if helpful):

Hovering tiles highlights and shows AP; clicking moves the player and camera tracks smoothly.

End Turn completes without the “Cannot end turn” log and returns control to the player.

Map transition still centers the camera on the spawn tile.

No “must be used within Provider” / hook-order warnings during fresh load or hot reload.